!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@walas/angular-vendor-browser"),require("@walas/angular-vendor")):"function"==typeof define&&define.amd?define(["exports","@walas/angular-vendor-browser","@walas/angular-vendor"],t):t((e.WALAS=e.WALAS||{},e.WALAS.walasAngularCore=e.WALAS.walasAngularCore||{}),e.WALAS.walasAngularVendorBrowser,e.WALAS.walasAngularVendor)}(this,function(e,t,n){"use strict";function r(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function i(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function o(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var u,l,c,s,f,d,p,h=function(){var e=function(e){return!!e.selector};return function(t){var n=Object.getPrototypeOf(t.prototype).constructor,r=Reflect.getMetadata("annotations",n).filter(function(t){return e(t)})[0],i=Reflect.getMetadata("annotations",t).filter(function(t){return e(t)})[0],o=Object.assign({},r,i);Object.assign(i,o)}},m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},w=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},O=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},k=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),j=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},P=(u=n.Injectable())(l=function(){function e(){v(this,e),this._form=null,this._controls=[]}return y(e,[{key:"addControl",value:function(e,t){e&&t&&this._controls.push(b({},e,{controlName:t}))}},{key:"dispose",value:function(){this._controls=[],this._form=null}},{key:"form",set:function(e){var t=this;this._form=e,this._form&&this._controls.forEach(function(e){return t._form.addControl(e)})}}]),e}())||l,A=(c=n.Component({selector:"af-form",template:'<form #frm="ngForm">\n    <ng-content></ng-content>\n</form>',providers:[P]}),s=n.ViewChild("frm"),c((d=function(){function e(t){v(this,e),r(this,"form",p,this),this._formService=t}return y(e,[{key:"ngAfterViewInit",value:function(){this._formService.form=this.form}},{key:"ngOnDestroy",value:function(){this._formService.dispose()}}]),e}(),p=function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(d.prototype,"form",[s],{enumerable:!0,initializer:function(){return this.form}}),f=d))||f);Reflect.defineMetadata("design:paramtypes",[P],A);var M,C,z={useI18n:!0,i18nLibrary:"i18next"},S=function e(){v(this,e),Object.assign(this,z)},V={namespace:"WALAS"},E=function(){function e(){v(this,e),Object.assign(this,V)}return y(e,[{key:"namespace",get:function(){return this._namespace},set:function(e){this._namespace=e}}]),e}(),R={modelKeyword:"$model",validatorLibray:{},customValidators:{},validators:{},validations:{}},I=function(){function e(){v(this,e),Object.assign(this,R)}return y(e,[{key:"init",value:function(){this._mergeValidators()}},{key:"_mergeValidators",value:function(){this.validators=b({},this.customValidators,this.validatorsLibrary)}},{key:"addValidators",value:function(){}},{key:"addValidations",value:function(){}},{key:"validations",get:function(){return this._validations},set:function(e){this._validations=e}},{key:"validators",get:function(){return this._validators},set:function(e){this._validators=e}},{key:"modelKeyword",get:function(){return this._modelKeyword},set:function(e){this._modelKeyword=e}}]),e}(),L=function(){function e(e){return function(){var t=this;e.map(function(e){return e.constructor&&Object.assign(t,new e.constructor)})}}function t(e,t){t.map(function(t){return Reflect.ownKeys(t).map(function(n){return Reflect.defineProperty(e.prototype,n,Reflect.getOwnPropertyDescriptor(t,n))})})}function n(e,t,n){n&&n.map(function(n){e.prototype[n]=function(){t.map(function(e){return e[n]&&e[n]()})}})}for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];if(i[0]&&i.some(function(e){return"string"!=typeof e}))throw new Error("Invalid propsToMix, must be of the type string");return function(){for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];if(o.some(function(e){return"function"!=typeof e}))throw new Error("Invalid classes, must be of the type function");var u=o.map(function(e){return e.prototype}),l=e(u);return t(l,u),n(l,u,i),l}},N=["init"],x=L.apply(void 0,N),T=function(e){function t(){return v(this,t),O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return w(t,e),y(t,[{key:"init",value:function(e){this._mergeConfig(e),_(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"_mergeConfig",value:function(e){Object.assign(this,e)}}]),t}(x(S,E,I)),F=new T,W=(M=n.Injectable())(C=function(){function e(t){v(this,e),this._compiler=t}return y(e,[{key:"load",value:function(e){var t=this,n=this._splitPath(e),r=n.modulePath,i=n.moduleName,o=F.getNamespace();return new Promise(function(n,a){var u=t._getModule(o,i);u&&n(u);var l=document.createElement("script");l.src=r,l.onload=function(){u=t._getModule(o,i),u||a(i+" could not be found although "+r+" was correctly loaded"),t._compiler.compileModuleAsync(u).then(function(e){l.remove(),n(e)}).catch(function(e){a(e)})},l.onerror=function(t){a("Could not load "+e)},document.head.appendChild(l)})}},{key:"_splitPath",value:function(e){var t=e.split("#"),n=k(t,2);return{modulePath:n[0],moduleName:n[1]}}},{key:"_getModule",value:function(e,t){return window&&window[e]&&window[e][t]}}]),e}())||C;Reflect.defineMetadata("design:paramtypes",[n.Compiler],W);var D,K,q,B,G,$,H,J={provide:n.NgModuleFactoryLoader,useClass:W},Q=function(e){return"app/src/modules/"+e+"/dist/"+e+".js"},U=function(e){return Q(e)+"#"+e},X=function(){return Object.keys(window.routes).map(function(e){return{path:window.routes[e].path,loadChildren:U(e)}})},Y=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(j(X()),t)},Z=(D=n.Injectable())(K=function(){function e(){v(this,e),this._model=null}return y(e,[{key:"model",set:function(e){this._model=e},get:function(){return this._model}}]),e}())||K,ee=(q=n.Directive({selector:"[model]",providers:[Z]}),B=n.Input(),q(($=function(){function e(t,n){v(this,e),i(this,"model",H,this),this._vcRef=t,this._modelService=n,this._path=null}return y(e,[{key:"ngOnInit",value:function(){this._path=this._transformModelToPath(),this._setComponentAttrs(),this._setModelServiceModel()}},{key:"_transformModelToPath",value:function(){this.model||this._throwModelError("No value was given for the model."),1===this.model.split(".").length&&this._throwModelError("Cannot write directly into the model, a property must be specified.")}},{key:"_setComponentAttrs",value:function(){var e=this._getComponent();e.prop=this._getProp(),e.target=this._getTarget(),e.name=this._getName()}},{key:"_getProp",value:function(){return this._path[this._path.length-1]}},{key:"_getTarget",value:function(){return this._path.slice(1,this._path.length-1).reduce(function(e,t){return e[t]=e[t]||{},e[t]},this._getParentModel())}},{key:"_getParentModel",value:function(){var e=this._path[0],t=this._getParentComponent(),n=t[e]=t[e]||{};return"object"!==(void 0===n?"undefined":m(n))&&this._throwModelError("The base model must be of type object."),n}},{key:"_getName",value:function(){return this.model.replace(/\./g,"_")}},{key:"_setModelServiceModel",value:function(){this._modelService.model=this._getParentModel()}},{key:"_getComponent",value:function(){return this._vcRef._data.componentView.component}},{key:"_getParentComponent",value:function(){return this._vcRef._view.component}},{key:"_throwModelError",value:function(e){var t="component: "+this._getComponent().constructor.name+" inside: "+this._getParentComponent().constructor.name;throw new Error(e+" At "+t)}}]),e}(),H=function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}($.prototype,"model",[B],{enumerable:!0,initializer:function(){return null}}),G=$))||G);Reflect.defineMetadata("design:paramtypes",[n.ViewContainerRef,Z],ee);var te,ne,re,ie,oe,ae,ue,le={provide:n.NG_VALIDATORS,useExisting:n.forwardRef(function(){return ce}),multi:!0},ce=(te=n.Directive({selector:"[rule][ngModel]",providers:[le]}),ne=n.Input("rule"),re=n.Input(),te((oe=function(){function e(t){v(this,e),o(this,"path",ae,this),o(this,"setValidity",ue,this),this._modelService=t}return y(e,[{key:"ngOnInit",value:function(){this.path&&(this.validationFunctions=this._getValidationFunctions())}},{key:"validate",value:function(e){if(this.path){var t=n.Validators.compose(this.validationFunctions)(e);return this.setValidity(!t),t}}},{key:"_getValidationFunctions",value:function(){var e=this;return this._getValidations().map(function(t){var n=e._getValidationParams(t),r=n.func,i=n.args,o=n.msg,a=n.fromModel;return function(t){var n=a?e._modelService.model:{},u=[t.value||""].concat(i);return r.apply(n,u)?null:g({},r.name,o)}})}},{key:"_getValidations",value:function(){var e=this.path.split("."),t=e[0],n=e[1];return F.getValidations()[t][n]}},{key:"_getValidationParams",value:function(e){var t=this._getValidatonName(e),n=e[t],r=n.arguments||[],i=F.getValidators(),o=F.getModelKeyword();return{func:i[t],args:r.filter(function(e){return e!==o}),msg:n.message||F.getDefaultValidationError(),fromModel:r.includes(o)}}},{key:"_getValidatonName",value:function(e){return Object.keys(e)[0]}}]),e}(),ae=a(oe.prototype,"path",[ne],{enumerable:!0,initializer:function(){return null}}),ue=a(oe.prototype,"setValidity",[re],{enumerable:!0,initializer:function(){return null}}),ie=oe))||ie);Reflect.defineMetadata("design:paramtypes",[Z],ce);var se,fe,de=[ce,ee,A],pe=(se=n.NgModule({imports:[n.FormsModule,n.CommonModule],exports:de,declarations:de}))(fe=function e(){v(this,e)})||fe;e.WalasAngularCore=pe,e.ExtendComponent=h,e.AfForm=A,e.FormService=P,e.AfModuleLoader=W,e.AfModuleLoaderProvider=J,e.getPathToModule=Q,e.getChildrenPath=U,e.resolveRoutes=X,e.composeRoutes=Y,e.Model=ee,e.ModelService=Z,e.Rule=ce,e.configService=F,e.mixinWithComposition=L,Object.keys(n).forEach(function(t){e[t]=n[t]}),Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=walas_angular_core.min.js.map
